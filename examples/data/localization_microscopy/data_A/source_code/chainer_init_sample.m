function sample = chainer_init_sample(params,opts)

%% counter
sample.i = 0;

%% positions
sample.x = params.x_prior_min + (params.x_prior_max-params.x_prior_min)*rand;
sample.y = params.y_prior_min + (params.y_prior_max-params.y_prior_min)*rand;

%% emission rates
sample.h = params.h_prior_ref/params.h_prior_phi*randg(params.h_prior_phi);
sample.C = params.C_prior_ref/params.C_prior_phi*randg(params.C_prior_phi);

%% book-keeping
u_cnt = params.t_exp*sample.C*(params.gx_max-params.gx_min)/params.Px ...
                             *(params.gy_max-params.gy_min)/params.Py ...
      + params.t_exp*sample.h*img_get_PSF(sample.x,sample.y,...
                                          params.dx,params.dy,...
                                          params.Px,params.Py,...
                                          params.Qx,params.Qy,...
                                          params.Kx,params.Ky,...
                                          params.Rx,params.Ry,...
                                          params.fx_mid,params.fy_mid,...
                                          params.gx_min,params.gy_min,...
                                          params.gx_max,params.gy_max,...
                                          params.fx_min,params.fy_min,...
                                          params.fx_max,params.fy_max,...
                                          params.f_nom,'r');
sample.L = get_log_like(u_cnt,params.dW_cnt,params.wV,params.wG,params.wF);

sample.P = get_log_probs(sample.x,sample.y,sample.h,sample.C,params);

sample.rec = repmat([0;realmin;0],1,2);


